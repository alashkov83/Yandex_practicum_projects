# Проект «Прогнозирование заказов такси»

## Стек: Python, Pandas, NumPy, Statsmodels, LigthGBM  Scikit-learn, Matplotlib, Seaborn

## Описание проекта

Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Постройте модель для такого предсказания.
Значение метрики RMSE на тестовой выборке должно быть не больше 48.

## План работы

1. Загрузить данные и выполнить их ресемплирование по одному часу.
2. Проанализируйте данные.
3. Обучить разные модели с различными гиперпараметрами. Создать тестовую выборку размером 10% от исходных данных.
4. Проверить модели на тестовой выборке.

## Результаты и выводы

1. Данные загружены и отсортированы по времени. Индекс монотонный. Данные записаны с 1 марта 2018 года по 31 августа 2018 года с шагом в 10 минут.
2. Проведен ресемплинг данных к интервалу в 1 час. При ресемплинеге количество заказов суммировалось.
3. Проеден анализ временного ряда. Cреднее количестов заказов за час 84, медианное - 78. Методом скользящего среднего определено, что среднее число заказов монотонно возрастает.
4. Проведена декомпозиция временного ряда. Определена недельная и суточная сезонность.
5. Для прогнозирование временного ряда были сконструированы. В качестве календарных признаков выступали день месяца, день недели и час суток. Также были включены запаздывающие признаки (lag) и признаки основанные на скользящем среднем (rolliing).
6. Проведено разделения общего набора данных в соотношении обучающего и тестового набора: 9:1 соответственно.
7. Подбор наиболее важных гиперпараметров осуществлён, используя GridSearchCV с методом перекрёстной валидации с TimeSeriesSplit.
8. Рассмотрены разные модели:

    1. Линейная регрессия
    2. Гребневая регрессия.
    3. Метод опорных векторов.

9. Все исследованные модели показывают адекватность.
10. Лучшее значение у гребневой регрессии (RMSE = 24.1. на кросс-валидации).
11. Лучшая по метрике при кросс-валидации модель испытана на тестовом наборе (RMSE = 41.5).
12. Было замечено, что используя недельную сезонность, можно предсказывать ряд с достаточной для заказчика точностью без использования модели машинного обучения (RMSE = 39.5).
